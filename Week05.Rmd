---
title: "Week05"
author: "CXiao"
date: "5/1/2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

### Load library  
```{r message = F, warning = F}
library(tidyverse)
library(Hmisc)
library(maps)
```

### Read in data  
```{r message = F, warning = F}
dfASC <- read_csv("data/acs2015_county_data.csv")
```

### Counties
```{r}
cnty <- map_data("county")
```

## plot  
### Plot counties
```{r message = F, warning = F, fig.width = 10}
p <- ggplot(cnty, aes(long, lat, group = group)) + 
  geom_polygon(aes(fill = region), 
               show.legend = FALSE, 
               colour = rgb(1, 1, 1, 0.2)) + 
  coord_quickmap()+
  theme_void()
p
```

### plotly  
```{r message = F, warning = F, fig.width = 10}
library(plotly)
#ggplotly(p)
```

## `choroplethr` framework  
```{r message = F, warning = F}
# https://bookdown.org/rdpeng/RProgDA/mapping.html#mapping-us-counties-and-states
# https://github.com/trulia/choroplethr
library(choroplethr)
library(choroplethrMaps)
data(df_pop_county)
```


### Test 
```{r}
# https://twitter.com/nlj/status/991149834085289984
mean_commute <- dfASC %>%
  select(CensusId, MeanCommute) %>%
  rename(region = CensusId, value = MeanCommute)

choro               <- CountyChoropleth$new(mean_commute)
choro$title         <- "Mean Commute Times by County"
choro$ggplot_scale  <- scale_fill_brewer(name = "Time", palette = 2, drop = F)
choro$render()
```

